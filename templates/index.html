<!--
Feature Status Tracker Documentation

Overview:
This HTML template implements a feature status tracking interface with interactive cards, charts, and comparison views.

Components:
1. Header Section
   - Title: Feature Status Tracker
   - Dependencies: Chart.js library, custom CSS stylesheet

2. Control Panel
   - Expand All button: Shows all feature details
   - Collapse All button: Hides all feature details
   - SVG icons for visual representation

3. Statistics Cards
   - Supported Features Card: Shows count of implemented features
   - Chart Card: Displays doughnut chart visualization
   - Features to Enhance Card: Shows count of pending enhancements

4. Feature Comparisons Section
   - Expandable feature cards
   - Two-column layout showing supported and enhancement details
   - Interactive toggle functionality

JavaScript Functions:
1. toggleFeature(header)
   - Purpose: Toggles visibility of feature details
   - Parameters: header - DOM element of feature header
   - Behavior: Expands/collapses feature details with animation

2. toggleAllFeatures(expand)
   - Purpose: Controls visibility of all feature cards
   - Parameters: expand - boolean flag for expand/collapse
   - Behavior: Expands or collapses all feature cards simultaneously

3. highlightFeatures(type)
   - Purpose: Highlights features based on category
   - Parameters: type - 'supported' or 'enhance'
   - Behavior: Highlights and expands relevant feature cards

4. Chart Initialization
   - Type: Doughnut chart
   - Data: Supported vs Enhancement features
   - Error handling: Comprehensive error checking
   - Tooltip: Shows count and percentage

Template Variables:
- stats.supported: Count of supported features
- stats.to_enhance: Count of features needing enhancement
- feature_comparisons: Dictionary of feature comparison data

CSS Dependencies:
- style.css: Custom styling for components
-->

<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Feature Status Tracker</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <nav class="top-nav">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="{{ url_for('static', filename='image.png') }}" alt="Logo">
                <span>Feature Analyzer</span>
            </div>
            <!-- <div class="nav-links">
                <a href="#" class="active"><i class="fas fa-home"></i> Dashboard</a>
                <a href="#"><i class="fas fa-chart-bar"></i> Analytics</a>
                <a href="#"><i class="fas fa-history"></i> History</a>
                <a href="#"><i class="fas fa-cog"></i> Settings</a>
            </div> -->
        </div>
    </nav>
    <!-- Add this stepper section before your existing content -->
    <!-- Replace the existing stepper section -->
    <div id="inputContainer">
        <div class="input-group">
            <label>Customer URL</label>
            <div class="input-wrapper">
                <i class="fas fa-link input-icon"></i>
                <input type="url" id="customerUrl" placeholder="https://example.com">
            </div>
        </div>
        <div class="input-group">
            <label>Upload Document</label>
            <div class="file-upload-wrapper">
                <input type="file" id="documentUpload" accept=".pdf,.doc,.docx">
                <div class="file-upload-label">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <span>Choose a file or drag it here</span>
                </div>
            </div>
        </div>
        <div class="input-group">
            <label>Custom Prompt</label>
            <div class="input-wrapper">
                <textarea id="promptInput" placeholder="Enter your instructions or requirements here..."></textarea>
                <div class="textarea-footer">
                    <span class="char-count">0/500</span>
                </div>
            </div>
        </div>
        <div class="button-group">
        <button class="next-btn" onclick="proceedToStep2()">Submit</button>
        <button class="next-btn" onclick="resetForm()">Reset</button>
    </div>
    </div>
    <div class="stepper-container">
        <!-- <div class="stepper"> -->
        <button class="back-btn" onclick="goBack()">
            <svg viewBox="0 0 24 24" width="24" height="24" fill="none" stroke="currentColor">
                <path d="M19 12H5M12 19l-7-7 7-7" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
        </button>
        <div class="stepper">
            <!-- Step indicators -->
            <!-- <div class="step completed" onclick="selectStep(0)">
                <div class="step-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M19 14l-7 7m0 0l-7-7m7 7V3" stroke-width="2" />
                    </svg>
                </div>
                <div class="step-label">STEP 1</div>
                <div class="step-title">Collecting Inputs</div>
                <div class="step-status">Completed</div>
            </div> -->
            <!-- Other step indicators remain the same -->
            <!-- </div> -->

            <div class="step completed" onclick="selectStep(1)">
                <div class="step-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M4 4v16m0 0h16M4 20l16-16" stroke-width="2" />
                    </svg>
                </div>
                <div class="step-label">STEP 1</div>
                <div class="step-title">Scrape Details</div>
                <div class="step-status">Completed</div>
            </div>

            <div class="step in-progress" onclick="selectStep(2)">
                <div class="step-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M8 6v12m8-12v12M3 10h18M3 14h18" stroke-width="2" />
                    </svg>
                </div>
                <div class="step-label">STEP 2</div>
                <div class="step-title">Comparing Features</div>
                <div class="step-status">In Progress</div>
            </div>

            <div class="step" onclick="selectStep(3)">
                <div class="step-icon">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                        <path d="M4 4h16v16H4V4zm4 4h8m-8 4h8m-8 4h4" stroke-width="2" />
                    </svg>
                </div>
                <div class="step-label">STEP 3</div>
                <div class="step-title">Summary</div>
                <div class="step-status">Pending</div>
            </div>

        </div>

        <div class="step-content-container">
            <div class="step-content" id="activeStepContent"></div>
        </div>
    </div>

    <!-- Add this script section after your existing scripts -->
    <script>
        function goBack() {
            const dashboard = document.getElementById('dashboardContainer');
            const stepperContainer = document.querySelector('.stepper-container');
            const inputContainer = document.getElementById('inputContainer');

            // Hide dashboard if it's visible
            if (dashboard.style.display === 'block') {
                dashboard.style.display = 'none';
            }

            // Go back to input form
            stepperContainer.style.display = 'none';
            inputContainer.style.display = 'block';
        }
        function selectStep(stepIndex) {
            // const dashboard = document.getElementById('dashboardContainer');
            // dashboard.style.display = 'none';
            // document.querySelector('.stepper-container').style.display = 'block';
            const dashboard = document.getElementById('dashboardContainer');
            dashboard.style.display = 'none';

            // const steps = document.querySelectorAll('.step');
            // const stepDetails = document.querySelectorAll('.step-details');

            // steps.forEach((step, index) => {
            //     if (index === stepIndex) {
            //         step.classList.add('active', 'in-progress');
            //     } else if (index < stepIndex) {
            //         step.classList.add('completed');
            //         step.classList.remove('active', 'in-progress');
            //     } else {
            //         step.classList.remove('completed', 'active', 'in-progress');
            //     }
            // });

            // updateStepContent(stepIndex);
            // updateProgressLine(stepIndex, steps.length);
            const stepperContainer = document.querySelector('.stepper-container');
            const inputContainer = document.getElementById('inputContainer');

            if (stepIndex === 0) {
                stepperContainer.style.display = 'none';
                inputContainer.style.display = 'block';
            } else {
                stepperContainer.style.display = 'block';
                inputContainer.style.display = 'none';
            }

            const steps = document.querySelectorAll('.step');
            steps.forEach((step, index) => {
                if (index === stepIndex) {
                    step.classList.add('active', 'in-progress');
                } else if (index < stepIndex) {
                    step.classList.add('completed');
                    step.classList.remove('active', 'in-progress');
                } else {
                    step.classList.remove('completed', 'active', 'in-progress');
                }
            });

            updateStepContent(stepIndex);
            updateProgressLine(stepIndex, steps.length);

        }

        function showDashboard() {
            // document.getElementById('dashboardContainer').style.display = 'block';
            const dashboard = document.getElementById('dashboardContainer');
            dashboard.style.display = 'block';
            document.querySelector('.stepper-container').style.display = 'block';

            // Smooth scroll to dashboard
            dashboard.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
        function updateStepContent(stepIndex) {

            const contentContainer = document.getElementById('activeStepContent');
            contentContainer.style.display = 'block';
            switch (stepIndex) {
                case 0:
                    contentContainer.innerHTML = `
                        <div id="inputContainer">
                            <div class="input-group">
                                <label>Customer URL</label>
                                <div class="input-wrapper">
                                    <i class="fas fa-link input-icon"></i>
                                    <input type="url" id="customerUrl" placeholder="https://example.com">
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Upload Document</label>
                                <div class="file-upload-wrapper">
                                    <input type="file" id="documentUpload" accept=".pdf,.doc,.docx">
                                    <div class="file-upload-label">
                                        <i class="fas fa-cloud-upload-alt"></i>
                                        <span>Choose a file or drag it here</span>
                                    </div>
                                </div>
                            </div>
                            <div class="input-group">
                                <label>Custom Prompt</label>
                                <div class="input-wrapper">
                                    <textarea id="promptInput" placeholder="Enter your instructions or requirements here..."></textarea>
                                    <div class="textarea-footer">
                                        <span class="char-count">0/500</span>
                                    </div>
                                </div>
                            </div>
                            <button class="next-btn" onclick="proceedToStep2()">Submit</button>
                        </div>
                        
                        <div class="stepper-container" style="display: none;">
                            <!-- Keep only steps 2-4 in the stepper -->
                            <div class="stepper">
                                <div class="step" onclick="selectStep(1)">
                                    <!-- Step 2 content -->
                                </div>
                                <div class="step" onclick="selectStep(2)">
                                    <!-- Step 3 content -->
                                </div>
                                <div class="step" onclick="selectStep(3)">
                                    <!-- Step 4 content -->
                                </div>
                            </div>
                        </div>
                    `;
                    break;
                case 1:
                    contentContainer.innerHTML = `
                        <div class="terminal-window">
                            <div class="terminal-header">
                                <div class="terminal-dots">
                                    <span></span><span></span><span></span>
                                </div>
                                <div class="terminal-title">Scraping Progress</div>
                            </div>
                            <div class="terminal-content" id="scrapeOutput">
                                </div>
                        </div>
                        <button class="next-btn" onclick="proceedToStep3()">Compare Results</button>
                    `;
                    break;
                case 2:
                    contentContainer.innerHTML = `
                        <div class="terminal-window">
                            <div class="terminal-header">
                                <div class="terminal-title">Comparison Results</div>
                            </div>
                            <div class="terminal-content" id="comparisonOutput">
                                </div>
                        </div>
                        <button class="next-btn" onclick="proceedToStep4()">Generate Summary</button>
                    `;
                    break;
                case 3:
                    contentContainer.innerHTML = `
                        <div class="summary-content" id="summaryOutput"></div>
                        <button class="dashboard-link" onclick="showDashboard()">View Dashboard</button>
                    `;
                    break;
            }
        }

        function updateProgressLine(stepIndex, totalSteps) {
            const progressLine = document.querySelector('.stepper::before');
            if (progressLine) {
                const progress = (stepIndex / (totalSteps - 1)) * 100;
                progressLine.style.background = `linear-gradient(to right, 
                    #34d399 ${progress}%, 
                    rgba(255, 255, 255, 0.1) ${progress}%
                )`;
            }
        }

        function proceedToStep2() {
            // const url = document.getElementById('customerUrl')?.value;
            // const file = document.getElementById('documentUpload')?.files[0];
            // const prompt = document.getElementById('promptInput')?.value;
            const url = document.getElementById('customerUrl');
            const file = document.getElementById('documentUpload');
            const prompt = document.getElementById('promptInput');
            //let isValid = true;
            let isValid = true;
            // Reset previous error states
            //  [url, file, prompt].forEach(field => {
            //         field.classList.remove('error');
            //         const wrapper = field.closest('.input-wrapper, .file-upload-wrapper');
            //         if (wrapper) wrapper.classList.remove('error');
            //     });

            // // Validate URL
            // if (!url.value.trim()) {
            //     url.closest('.input-wrapper').classList.add('error');
            //     isValid = false;
            // }

            // // Validate File
            // if (!file.files || file.files.length === 0) {
            //     file.closest('.file-upload-wrapper').classList.add('error');
            //     isValid = false;
            // }

            // Validate Prompt
            // if (!prompt.value.trim()) {
            //     prompt.closest('.input-wrapper').classList.add('error');
            //     isValid = false;
            // }
            if (url) {
                const urlWrapper = url.closest('.input-wrapper');
                if (urlWrapper) urlWrapper.classList.remove('error');
            }

            if (file) {
                const fileWrapper = file.closest('.file-upload-wrapper');
                if (fileWrapper) fileWrapper.classList.remove('error');
            }

            if (prompt) {
                const promptWrapper = prompt.closest('.input-wrapper');
                if (promptWrapper) promptWrapper.classList.remove('error');
            }

            // Validate URL
            if (!url?.value?.trim()) {
                url?.closest('.input-wrapper')?.classList.add('error');
                isValid = false;
            }

            // Validate File
            if (!file?.files?.[0]) {
                file?.closest('.file-upload-wrapper')?.classList.add('error');
                isValid = false;
            }

            // Validate Prompt
            if (!prompt?.value?.trim()) {
                prompt?.closest('.input-wrapper')?.classList.add('error');
                isValid = false;
            }

            if (!isValid) {
                // alert('Please fill in all required fields');
                return;
            }
            // if (!url || !file || !prompt) {
            //     alert('Please fill in all fields');
            //     return;
            // }

            selectStep(1);
            simulateScraping();
        }
        // Add this function after your existing functions
        function resetForm() {
            // Reset URL input
            const urlInput = document.getElementById('customerUrl');
            if (urlInput) {
                urlInput.value = '';
                urlInput.closest('.input-wrapper')?.classList.remove('error');
            }

            // Reset file input
            const fileInput = document.getElementById('documentUpload');
            if (fileInput) {
                fileInput.value = '';
                const wrapper = fileInput.closest('.file-upload-wrapper');
                wrapper?.classList.remove('error');
                const label = wrapper?.querySelector('.file-upload-label span');
                if (label) {
                    label.textContent = 'Choose a file or drag it here';
                }
            }

            // Reset prompt input
            const promptInput = document.getElementById('promptInput');
            if (promptInput) {
                promptInput.value = '';
                promptInput.closest('.input-wrapper')?.classList.remove('error');
            }

            // Reset character count
            const charCount = document.querySelector('.char-count');
            if (charCount) {
                charCount.textContent = '0/500';
            }
        }

        function typeText(text, elementId, speed = 30) {
            const element = document.getElementById(elementId);
            let index = 0;
            element.innerHTML = '';

            function type() {
                if (index < text.length) {
                    element.innerHTML += text.charAt(index);
                    index++;
                    // Auto-scroll to bottom
                    element.scrollTop = element.scrollHeight;
                    setTimeout(type, speed);
                }
            }

            type();
        }
        function simulateScraping() {
            const text = `Vibe coding is an AI-dependent programming practice where a programmer describes a problem in a few sentences as a prompt to a large language model (LLM) tuned for coding. This approach allows software to be quickly created and debugged while ignoring the details of the generated code 1 2. The term was introduced by Andrej Karpathy, a co-founder of OpenAI and former AI...`;

            typeText(text, 'scrapeOutput');

            // Add completed class after typing is done
            setTimeout(() => {
                document.querySelector('.step:nth-child(2)').classList.add('completed');
            }, text.length * 30 + 500);
        }
        function proceedToStep3() {
            if (!document.querySelector('.step:nth-child(2).completed')) {
                alert('Please complete the scraping process first');
                return;
            }
            selectStep(2);
            showComparison();
        }
        function showComparison() {
            const comparisonText = `Vibe coding is an AI-dependent programming practice where a programmer describes a problem in a few sentences as a prompt to a large language model (LLM) tuned for coding. This approach allows software to be quickly created and debugged while ignoring the details of the generated code 1 2. The term was introduced by Andrej Karpathy, a co-founder of OpenAI and former AI...`;

            typeText(comparisonText, 'comparisonOutput');

            // Add completed class after typing is done
            setTimeout(() => {
                document.querySelector('.step:nth-child(3)').classList.add('completed');
            }, comparisonText.length * 30 + 500);
        }
        function showSummary() {
            const summaryText = `Vibe coding is an AI-dependent programming practice where a programmer describes a problem in a few sentences as a prompt to a large language model (LLM) tuned for coding. This approach allows software to be quickly created and debugged while ignoring the details of the generated code 1 2. The term was introduced by Andrej Karpathy, a co-founder of OpenAI and former AI...`;

            typeText(summaryText, 'summaryOutput');

            // Add completed class after typing is done
            setTimeout(() => {
                document.querySelector('.step:nth-child(4)').classList.add('completed');
            }, summaryText.length * 30 + 500);
        }
        function proceedToStep4() {
            if (!document.querySelector('.step:nth-child(3).completed')) {
                alert('Please complete the comparison process first');
                return;
            }
            selectStep(3);
            showSummary();
        }
    </script>

    <!-- Your existing content starts here -->
    <div class="container" id="dashboardContainer" style="display: none; margin-top: 40px;">
        <h1>✓ Feature Status Tracker</h1>

        <div class="controls">
            <button class="control-btn" onclick="toggleAllFeatures(true)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M4 9h16M4 15h16" stroke-width="2" stroke-linecap="round" />
                </svg>
                Expand All
            </button>
            <button class="control-btn" onclick="toggleAllFeatures(false)">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor">
                    <path d="M19 9l-7 7-7-7" stroke-width="2" stroke-linecap="round" />
                </svg>
                Collapse All
            </button>
        </div>

        <div class="stats-cards">
            <div class="card supported" data-type="supported" onclick="highlightFeatures('supported')">
                <div class="card-header">
                    <span class="check-icon">✓</span> Supported Features
                </div>
                <div class="card-content">
                    <div class="number">{{ stats.supported }}</div>
                    <div class="subtitle">implemented features</div>
                </div>
            </div>

            <div class="card chart">
                <canvas id="featureChart"></canvas>
                <div class="legend">
                    <div class="legend-item">
                        <span class="dot supported"></span> Supported
                    </div>
                    <div class="legend-item">
                        <span class="dot enhance"></span> Need Enhancement
                    </div>
                </div>
            </div>

            <div class="card enhance" data-type="enhance" onclick="highlightFeatures('enhance')">
                <div class="card-header">
                    <span class="enhance-icon">⟲</span> Features to Enhance
                </div>
                <div class="card-content">
                    <div class="number">{{ stats.to_enhance }}</div>
                    <div class="subtitle">pending enhancements</div>
                </div>
            </div>
        </div>

        <div class="feature-comparisons">
            {% for feature_name, comparison in feature_comparisons.items() %}
            <div class="feature-card">
                <div class="feature-header" onclick="toggleFeature(this)">
                    <h3>{{ feature_name }}</h3>
                    <span class="expand-icon">▼</span>
                </div>
                <div class="feature-details">
                    <div class="comparison-grid">
                        <div class="supported-column">
                            <h4>Supported</h4>
                            {% if comparison.supported %}
                            <p>{{ comparison.supported }}</p>
                            {% else %}
                            <p class="na">Not Available</p>
                            {% endif %}
                        </div>
                        <div class="enhance-column">
                            <h4>Need to Enhance</h4>
                            {% if comparison.to_enhance %}
                            <p>{{ comparison.to_enhance }}</p>
                            {% else %}
                            <p class="na">Not Available</p>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <script>
        let chart;

        function toggleFeature(header) {
            const card = header.parentElement;
            const details = card.querySelector('.feature-details');

            document.querySelectorAll('.feature-card.expanded').forEach(expandedCard => {
                if (expandedCard !== card) {
                    expandedCard.classList.remove('expanded');
                    expandedCard.querySelector('.feature-details').style.maxHeight = "0";
                }
            });

            card.classList.toggle('expanded');

            if (card.classList.contains('expanded')) {
                details.style.maxHeight = details.scrollHeight + "px";
            } else {
                details.style.maxHeight = "0";
            }
        }

        function toggleAllFeatures(expand) {
            const cards = document.querySelectorAll('.feature-card');
            cards.forEach(card => {
                const details = card.querySelector('.feature-details');
                if (expand) {
                    card.classList.add('expanded');
                    details.style.maxHeight = `${details.scrollHeight}px`;
                } else {
                    card.classList.remove('expanded');
                    details.style.maxHeight = '0';
                }
            });
        }

        function highlightFeatures(type) {
            document.querySelectorAll('.feature-card').forEach(card => {
                card.classList.remove('highlighted-supported', 'highlighted-enhance');
                card.classList.remove('expanded');
                card.querySelector('.feature-details').style.maxHeight = "0";
            });

            document.querySelectorAll('.feature-card').forEach(card => {
                const hasSupported = card.querySelector('.supported-column p:not(.na)');
                const hasEnhance = card.querySelector('.enhance-column p:not(.na)');

                if (type === 'supported' && hasSupported) {
                    card.classList.add('highlighted-supported', 'expanded');
                    card.querySelector('.feature-details').style.maxHeight =
                        card.querySelector('.feature-details').scrollHeight + "px";
                } else if (type === 'enhance' && hasEnhance) {
                    card.classList.add('highlighted-enhance', 'expanded');
                    card.querySelector('.feature-details').style.maxHeight =
                        card.querySelector('.feature-details').scrollHeight + "px";
                }
            });
        }

        document.addEventListener('DOMContentLoaded', function () {
            const ctx = document.getElementById('featureChart');
            if (!ctx || !ctx.getContext) {
                console.error('Chart canvas element not found or context not available');
                return;
            }

            let supportedCount = 0;
            let enhanceCount = 0;

            try {
                const statsData = JSON.parse('{{ stats|tojson|safe }}');
                supportedCount = parseInt(statsData.supported) || 0;
                enhanceCount = parseInt(statsData.to_enhance) || 0;
            } catch (e) {
                console.error('Error parsing stats:', e);
                return;
            }

            // Register plugins before creating chart instance
            Chart.register({
                id: 'centerCursor',
                beforeEvent: function (chart, args) {
                    const event = args.event;
                    if (!event || !event.native) return;

                    const rect = chart.canvas.getBoundingClientRect();
                    const x = event.native.clientX - rect.left;
                    const y = event.native.clientY - rect.top;
                    const centerX = chart.chartArea.width / 2;
                    const centerY = chart.chartArea.height / 2;
                    const radius = Math.min(chart.chartArea.width, chart.chartArea.height) * 0.25;

                    const distance = Math.sqrt(Math.pow(x - centerX, 2) + Math.pow(y - centerY, 2));

                    chart.canvas.style.cursor = distance < radius ? 'pointer' : 'default';
                }
            });

            Chart.register({
                id: 'centerText',
                beforeDraw: function (chart) {
                    const width = chart.width;
                    const height = chart.height;
                    const ctx = chart.ctx;
                    const total = supportedCount + enhanceCount;

                    ctx.save();
                    ctx.textBaseline = "middle";
                    ctx.textAlign = "center";

                    ctx.font = "bold 32px 'Segoe UI'";
                    ctx.fillStyle = "#ffffff";
                    ctx.fillText(total, width / 2, height / 2 - 15);

                    ctx.font = "16px 'Segoe UI'";
                    ctx.fillStyle = "#a3a3a3";
                    ctx.fillText("Total Features", width / 2, height / 2 + 15);

                    const completionRate = total > 0 ? ((supportedCount / total) * 100).toFixed(0) : "0";
                    ctx.font = "14px 'Segoe UI'";
                    ctx.fillStyle = "#34d399";
                    ctx.fillText(`${completionRate}% Complete`, width / 2, height / 2 + 40);

                    ctx.restore();
                }
            });

            // Create chart instance after registering plugins
            // Replace the chart options section with this updated version
            chart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Supported', 'Need Enhancement'],
                    datasets: [{
                        data: [supportedCount, enhanceCount],
                        backgroundColor: ['#34d399', '#fb923c'],
                        borderWidth: 2,
                        borderColor: '#2d3035',
                        hoverBorderColor: '#ffffff',
                        hoverBorderWidth: 4,
                        hoverOffset: 10,
                        borderRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    cutout: '75%',
                    onClick: function (event, elements) {
                        if (!event.native) return;

                        const rect = chart.canvas.getBoundingClientRect();
                        const x = event.native.clientX - rect.left;
                        const y = event.native.clientY - rect.top;
                        const centerX = chart.width / 2;
                        const centerY = chart.height / 2;
                        const radius = Math.min(chart.width, chart.height) * 0.3;

                        const distance = Math.sqrt(
                            Math.pow(x - centerX, 2) +
                            Math.pow(y - centerY, 2)
                        );

                        if (distance < radius) {
                            // Reset all highlights and collapse all features
                            document.querySelectorAll('.feature-card').forEach(card => {
                                card.classList.remove('highlighted-supported', 'highlighted-enhance', 'expanded');
                                const details = card.querySelector('.feature-details');
                                details.style.maxHeight = '0';
                            });
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            backgroundColor: 'rgba(45, 48, 53, 0.9)',
                            titleFont: {
                                size: 16,
                                weight: 'bold'
                            },
                            bodyFont: {
                                size: 14
                            },
                            padding: 12,
                            cornerRadius: 8,
                            callbacks: {
                                label: function (context) {
                                    const total = supportedCount + enhanceCount;
                                    const percentage = ((context.raw / total) * 100).toFixed(1);
                                    return `${context.label}: ${context.raw} (${percentage}%)`;
                                }
                            }
                        }
                    },
                    animation: {
                        animateScale: true,
                        animateRotate: true,
                        duration: 1000
                    }
                }
            });

            // Add this to the centerText plugin to make the text clickable
            Chart.register({
                id: 'centerText',
                beforeDraw: function (chart) {
                    const width = chart.width;
                    const height = chart.height;
                    const ctx = chart.ctx;
                    const total = supportedCount + enhanceCount;

                    ctx.save();
                    ctx.textBaseline = "middle";
                    ctx.textAlign = "center";

                    ctx.font = "bold 32px 'Segoe UI'";
                    ctx.fillStyle = "#ffffff";
                    ctx.fillText(total, width / 2, height / 2 - 15);

                    ctx.font = "16px 'Segoe UI'";
                    ctx.fillStyle = "#a3a3a3";
                    ctx.fillText("Total Features", width / 2, height / 2 + 15);

                    const completionRate = total > 0 ? ((supportedCount / total) * 100).toFixed(0) : "0";
                    ctx.font = "14px 'Segoe UI'";
                    ctx.fillStyle = "#34d399";
                    ctx.fillText(`${completionRate}% Complete`, width / 2, height / 2 + 40);

                    ctx.restore();
                }
            });
        });
    </script>
    <!-- ... existing code ... -->
    <script>
        // Initialize step 1 on page load
        document.addEventListener('DOMContentLoaded', function () {
            const inputContainer = document.getElementById('inputContainer');
            const stepperContainer = document.querySelector('.stepper-container');

            inputContainer.style.display = 'block';
            stepperContainer.style.display = 'none';
        });
        document.addEventListener('DOMContentLoaded', function () {
            // URL input validation
            const urlInput = document.getElementById('customerUrl');
            urlInput?.addEventListener('input', function () {
                const wrapper = this.closest('.input-wrapper');
                if (this.value.trim()) {
                    wrapper?.classList.remove('error');
                }
            });

            // File input validation
            const fileInput = document.getElementById('documentUpload');
            fileInput?.addEventListener('change', function () {
                const wrapper = this.closest('.file-upload-wrapper');
                const label = wrapper?.querySelector('.file-upload-label span');

                if (this.files?.[0]) {
                    wrapper?.classList.remove('error');
                    if (label) {
                        label.textContent = this.files[0].name;
                    }
                } else {
                    if (label) {
                        label.textContent = 'Choose a file or drag it here';
                    }
                }
            });

            // Prompt input validation
            const promptInput = document.getElementById('promptInput');
            promptInput?.addEventListener('input', function () {
                const wrapper = this.closest('.input-wrapper');
                if (this.value.trim()) {
                    wrapper?.classList.remove('error');
                }
            });
        });
    </script>

</body>

</html>